!function(){let e=".stories-bar",t=".story",l=[],n=[],r=document.querySelector(".story-container.current-highlight"),i=document.querySelector(".highlight-loader").querySelectorAll(".highlight-list-item"),o=document.querySelector(".highlight-loader");function s(){let n=document.querySelectorAll(".story-container"),r=n[0].querySelector(e).cloneNode(!0);n.forEach((n,i)=>{if(!1==l.includes(n)){let o=n.querySelector(".stories-bar-wrap");n.querySelectorAll(`${t}`).forEach((e,t)=>{o.appendChild(r.cloneNode(!0))}),n.querySelector(e)&&n.querySelector(e).remove(),l.push(n)}}),l.forEach((e,l)=>{(function e(l){let n=[{width:"0%"},{width:"100%"}],r=l.querySelectorAll(".stories-progress"),i=l.querySelectorAll(t),o=[],s=[],c=window.innerWidth,h=Math.ceil(.2*l.getBoundingClientRect().width),u=0,a,d;function g(e){let t=e.target.getBoundingClientRect();a=Date.now(),d=e.clientX-t.left,o[u].pause()}function y(){Date.now()-a<100&&(d<h?u>0&&(o[u].cancel(),o[u-1].play(),i[u].style.zIndex=0,i[u-1].style.zIndex=2,u-=1):u!=o.length-1&&(o[u].finish(),o[u+1].play(),i[u].style.zIndex=0,i[u+1].style.zIndex=2,u+=1)),o[u].play()}i.forEach(e=>{e.getAttribute("data-duration")?s.push(parseInt(e.getAttribute("data-duration"))):s.push(3e3)}),r.forEach((e,t)=>{o.push(e.animate(n,{duration:s[t],fill:"forwards"})),t!=r.length-1&&(o[t].onfinish=function(){o[t+1].play(),i[t+1].style.zIndex=2,u=t+1})}),new IntersectionObserver(function(e,t){e.forEach(e=>{e.isIntersecting?(o.map((e,t)=>{t>0?(o[t].cancel(),o[t].pause()):(o[t].play(),i[0].style.zIndex=2,u=0)}),c>1024?(l.addEventListener("mousedown",e=>{g(e)}),l.addEventListener("mouseup",y)):(l.addEventListener("touchstart",e=>{g(e)}),l.addEventListener("touchend",y))):(o.map((e,t)=>{o[t].cancel(),o[t].pause(),t>0?i[t].style.zIndex=0:i[t].style.zIndex=2,u=0}),c>1024?l.removeEventListener("mouseup",y):l.removeEventListener("touchend",y))})},{root:null,threshold:.8}).observe(l)})(e)})}n.push(r),window.fsAttributes=window.fsAttributes||[],window.fsAttributes.push(["cmsload",e=>{let[t]=e,l=document.querySelector(".highlight-scroll-container");(i=document.querySelector(".highlight-loader").querySelectorAll(".highlight-list-item")).forEach(e=>{n.push(e),l.append(e)}),function e(t){t.addEventListener("scroll",function(){progress=t.scrollTop/(t.scrollHeight-window.innerHeight)*100,console.log(progress),progress>98&&(console.log("Past 96!"),$("#highlight-next")[0].getAttribute("style")||(console.log("clicked!"),$("#highlight-next")[0].click()))})}(l),s(),t.on("renderitems",e=>{e.map(e=>{n.includes(e.element)||(n.push(e.element),l.append(e.element))}),o.remove(),s()})},])}();
