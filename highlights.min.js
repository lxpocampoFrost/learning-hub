!function(){let e=".stories-bar",t=".story",l=[],n=document.querySelector(".story-container.current-highlight");function r(){let n=document.querySelectorAll(".story-container"),r=n[0].querySelector(e).cloneNode(!0);n.forEach((n,o)=>{if(!1==l.includes(n)){n.querySelector(".story-wrap");let i=n.querySelector(".stories-bar-wrap");n.querySelectorAll(`${t}`).forEach((e,t)=>{i.appendChild(r.cloneNode(!0))}),n.querySelector(e)&&n.querySelector(e).remove(),l.push(n)}}),l.forEach((e,l)=>{(function e(l){let n=[{width:"0%"},{width:"100%"}],r=l.querySelectorAll(".stories-progress"),o=l.querySelectorAll(t),i=[],s=[],c=window.innerWidth,u=l.getBoundingClientRect().width;console.log(l.getBoundingClientRect().width);let h=Math.ceil(.2*u),a=0,d,g;function y(e){let t=e.target.getBoundingClientRect();d=Date.now(),g=e.clientX-t.left,i[a].pause()}function p(){Date.now()-d<200&&(g<h?a>0&&(i[a].cancel(),i[a-1].play(),o[a].style.zIndex=0,o[a-1].style.zIndex=2,a-=1):a!=i.length-1&&(i[a].finish(),i[a+1].play(),o[a].style.zIndex=0,o[a+1].style.zIndex=2,a+=1)),i[a].play()}o.forEach(e=>{e.getAttribute("data-duration")?s.push(parseInt(e.getAttribute("data-duration"))):s.push(3e3)}),r.forEach((e,t)=>{i.push(e.animate(n,{duration:s[t],fill:"forwards"})),t!=r.length-1&&(i[t].onfinish=function(){i[t+1].play(),o[t+1].style.zIndex=2,a=t+1})}),new IntersectionObserver(function(e,t){e.forEach(e=>{e.isIntersecting?(i.map((e,t)=>{t>0?(i[t].cancel(),i[t].pause()):(i[t].play(),o[0].style.zIndex=2,a=0)}),c>1024?(l.addEventListener("mousedown",e=>{y(e)}),l.addEventListener("mouseup",p)):(l.addEventListener("touchstart",e=>{y(e.touches[0])}),l.addEventListener("touchend",p))):(i.map((e,t)=>{i[t].cancel(),i[t].pause(),t>0?o[t].style.zIndex=0:o[t].style.zIndex=2,a=0}),c>1024?l.removeEventListener("mouseup",p):l.removeEventListener("touchend",p))})},{root:null,threshold:.8}).observe(l)})(e)})}let o=[],i=document.querySelector(".highlight-loader").querySelectorAll(".highlight-list-item"),s=document.querySelector(".highlight-loader");o.push(n),window.fsAttributes=window.fsAttributes||[],window.fsAttributes.push(["cmsload",e=>{let[t]=e,l=document.querySelector(".highlight-scroll-container");(i=document.querySelector(".highlight-loader").querySelectorAll(".highlight-list-item")).forEach(e=>{o.push(e),l.append(e)}),function e(t){t.addEventListener("scroll",function(){(progress=t.scrollTop/(t.scrollHeight-window.innerHeight)*100)>98&&(console.log("Past 96!"),$("#highlight-next")[0].getAttribute("style")||(console.log("clicked!"),$("#highlight-next")[0].click()))})}(l),r(),t.on("renderitems",e=>{e.map(e=>{o.includes(e.element)||(o.push(e.element),l.append(e.element))}),s.remove(),r()})},])}();
